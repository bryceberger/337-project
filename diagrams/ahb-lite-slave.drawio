<mxfile host="65bd71144e">
    <diagram id="mPhPeCEU2sq3P_vmCf37" name="Top Level">
        <mxGraphModel dx="916" dy="694" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="12" style="edgeStyle=orthogonalEdgeStyle;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;rounded=0;" parent="1" source="ZwhexHDq3JxU943sYQ1g-1" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="280" y="100" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-1" value="&lt;div style=&quot;font-size: 13px&quot;&gt;ahb inputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;hsel&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;haddr[3:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;htrans[2:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;hsize[1:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;hwrite&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;hwdata[31:0]&lt;br style=&quot;font-size: 13px&quot;&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="40" y="40" width="180" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-2" value="&lt;div style=&quot;font-size: 13px&quot;&gt;address mapping&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0x0: 4 R/W data buffer&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0x4: 2 R&amp;nbsp;&amp;nbsp; status register&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0x6: 2 R&amp;nbsp;&amp;nbsp; error register&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0x8: 1 R&amp;nbsp;&amp;nbsp; buffer occupancy&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0xC: 1 R/W TX packet control&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0xD: 1 R/W flush buffer control&amp;nbsp;&lt;br style=&quot;font-size: 13px&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0xE: reserved&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;0xF: reserved&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontFamily=Courier New;fontStyle=0;labelBorderColor=default;" parent="1" vertex="1">
                    <mxGeometry x="40" y="505" width="270" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;endArrow=none;endFill=0;startArrow=classic;startFill=1;" parent="1" source="ZwhexHDq3JxU943sYQ1g-3" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="480" y="80" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-3" value="&lt;div style=&quot;font-size: 13px;&quot;&gt;ahb outputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;hrdata[31:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;hresp&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;hready&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="520" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;" parent="1" source="ZwhexHDq3JxU943sYQ1g-5" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="280" y="235" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-5" value="&lt;div style=&quot;font-size: 13px;&quot;&gt;rx inputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;rx_packet[3:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;rx_data_ready&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;rx_transfer_active&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;rx_error&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="40" y="190" width="180" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;fontSize=13;fontStyle=0" parent="1" source="ZwhexHDq3JxU943sYQ1g-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="280" y="345" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-6" value="&lt;div style=&quot;font-size: 13px;&quot;&gt;tx inputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;tx_transfer_active&lt;/div&gt;&lt;div style=&quot;font-size: 13px;&quot;&gt;tx_error&lt;br style=&quot;font-size: 13px;&quot;&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="40" y="310" width="180" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;endArrow=none;endFill=0;startArrow=classic;startFill=1;" parent="1" source="ZwhexHDq3JxU943sYQ1g-7" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="480" y="175.23809523809524" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="480" y="180"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-7" value="&lt;div style=&quot;font-size: 13px&quot;&gt;tx outputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;tx_packet[2:0]&lt;br style=&quot;font-size: 13px&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;tx_start&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="520" y="150" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;endArrow=none;endFill=0;startArrow=classic;startFill=1;" parent="1" source="ZwhexHDq3JxU943sYQ1g-8" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="480" y="255" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="480" y="260"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-8" value="&lt;div style=&quot;font-size: 13px&quot;&gt;&lt;div&gt;general outputs:&lt;/div&gt;&lt;div&gt;d_mode&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="520" y="235" width="160" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="ZwhexHDq3JxU943sYQ1g-9" value="AHB-lite Slave" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Courier New;fontSize=13;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="280" y="40" width="200" height="440" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="address decoder:&lt;br&gt;combinational:&lt;br&gt;// delay on err until recieve &quot;acknowledge&quot;&amp;nbsp;&lt;br&gt;&lt;div&gt;hready = !(hresp &amp;amp;&amp;amp; htrans != idle)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// error on:&lt;/div&gt;&lt;div&gt;// - write to read only&lt;/div&gt;&lt;div&gt;// - 1/2 byte r/w to invalid addresses&lt;/div&gt;&lt;div&gt;hresp&amp;nbsp; = (hwrite &amp;amp;&amp;amp;&amp;nbsp;haddr[2] &amp;amp;&amp;amp; !haddr[3])&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;|| (hsize != 2 &amp;amp;&amp;amp; haddr &amp;gt;= 0xE)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;enable = hsel&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// doesn't make sense to interact&lt;/div&gt;&lt;div&gt;//&amp;nbsp; &amp;nbsp; &amp;nbsp;with addresses 1, 2, 3&lt;/div&gt;&lt;div&gt;// otherwise, cut off lsb as determined&lt;/div&gt;&lt;div&gt;//&amp;nbsp; &amp;nbsp; &amp;nbsp;by hsize&lt;/div&gt;&lt;div&gt;&lt;span&gt;addr&amp;nbsp; &amp;nbsp;= haddr &amp;lt; 4&amp;nbsp; ? 0 :&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;hsize == 0 ? haddr :&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;hsize == 1 ? {haddr[3:1], 1'b0}&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; : {haddr[3:2], 2'b0}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ff: // data delayed for writes&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;addr_r &amp;lt;= addr&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;size_r &amp;lt;= hsize&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Courier New;labelBorderColor=default;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1155" width="330" height="370" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="hrdata:&lt;br&gt;always:&lt;br&gt;// have to set like this&lt;br&gt;// because saving locally would be&amp;nbsp;&lt;br&gt;// a clock cycle slow in the case&lt;br&gt;// of reading twice in a row&lt;br&gt;source =&lt;br&gt;&amp;nbsp; &amp;nbsp; if (haddr == 0)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rx_data&lt;br&gt;&amp;nbsp; &amp;nbsp; else&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; mem[haddr+3:haddr]&lt;br&gt;&lt;br&gt;ff:&lt;br&gt;&lt;div&gt;hrdata &amp;lt;=&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; if (enable &amp;amp;&amp;amp; !write)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (hsize == 2)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; source[3:0];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else if (hsize == 1)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; source[1:0];&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; source[0];&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Courier New;labelBorderColor=default;" parent="1" vertex="1">
                    <mxGeometry x="40" y="1555" width="270" height="310" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="Memory:&lt;br&gt;ff:&lt;br&gt;&lt;div&gt;mem['h4][0] &amp;lt;= rx_data_ready;&lt;/div&gt;&lt;div&gt;mem['h4][1] &amp;lt;= rx_packet == IN;&lt;/div&gt;&lt;div&gt;mem['h4][2] &amp;lt;= rx_packet == OUT;&lt;/div&gt;&lt;div&gt;mem['h4][3] &amp;lt;= rx_packet == ACK;&lt;/div&gt;&lt;div&gt;mem['h4][4] &amp;lt;= rx_packet == NACK;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;mem['h5][0] &amp;lt;= rx_transfer_active;&lt;/div&gt;&lt;div&gt;mem['h5][1] &amp;lt;= tx_transfer_active;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;mem['h6][0] &amp;lt;= rx_error;&lt;/div&gt;&lt;div&gt;mem['h6][7] &amp;lt;= tx_error;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;mem['h8]&amp;nbsp; &amp;nbsp; &amp;lt;= buffer_occupancy;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// hold while sending packet, reset after&lt;/div&gt;&lt;div&gt;// if top bit set, check for transfer active&lt;/div&gt;&lt;div&gt;// otherwise, set top bit if any bit set&lt;/div&gt;&lt;div&gt;// effectively delays checking transfer active 1 cycle&amp;nbsp;&lt;/div&gt;&lt;span&gt;mem['hc]&amp;nbsp; &amp;nbsp; &amp;lt;= &lt;br&gt;&amp;nbsp; &amp;nbsp; if (mem['hc][7] &amp;amp;&amp;amp; tx_transfer_active)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; mem['hc]&lt;br&gt;&amp;nbsp; &amp;nbsp; else&amp;nbsp;if (mem['hc])&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {1'b1, mem['hc][6:0]}&lt;br&gt;&amp;nbsp; &amp;nbsp; else&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 0&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// hold until buffer cleared&lt;/div&gt;&lt;div&gt;mem['hd]&amp;nbsp; &amp;nbsp; &amp;lt;= |buffer_occupancy ? mem['hd] : 0;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;// write control&lt;/div&gt;&lt;div&gt;&lt;div&gt;if (addr_r != 0 &amp;amp;&amp;amp; enable)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; case (size_r)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 0: mem[addr_r] &amp;lt;= hwdata[7:0];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1: mem[addr_r+1:addr_r] &amp;lt;= hwdata[15:0];&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 2: mem[addr_r+3:addr_r] &amp;lt;= hwdata;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Courier New;labelBorderColor=default;spacingTop=0;" parent="1" vertex="1">
                    <mxGeometry x="400" y="1360" width="410" height="540" as="geometry"/>
                </mxCell>
                <mxCell id="18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;endArrow=none;endFill=0;startArrow=classic;startFill=1;" parent="1" source="8" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="480" y="355.2380952380952" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="500" y="355"/>
                            <mxPoint x="500" y="355"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="8" value="&lt;div style=&quot;font-size: 13px&quot;&gt;&lt;div&gt;data buffer outputs:&lt;/div&gt;&lt;div&gt;get_rx_data[1:0]&lt;/div&gt;&lt;div&gt;store_tx_data[1:0]&lt;/div&gt;&lt;div&gt;tx_data[31:0]&lt;/div&gt;&lt;div&gt;clear_data_buffer&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="520" y="310" width="160" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Courier New;" parent="1" source="9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="280" y="445" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="9" value="&lt;div style=&quot;font-size: 13px&quot;&gt;data buffer inputs:&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;rx_data[31:0]&lt;/div&gt;&lt;div style=&quot;font-size: 13px&quot;&gt;buffer_occupancy[6:0]&lt;/div&gt;" style="whiteSpace=wrap;html=1;fontSize=13;fontFamily=Courier New;align=left;fontStyle=0" parent="1" vertex="1">
                    <mxGeometry x="40" y="410" width="180" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="output logic:&lt;br&gt;&lt;div&gt;&lt;span&gt;ff:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; tx_packet&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;lt;= mem['hc][2:0] - 1;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; tx_start&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;lt;= |mem['hc];&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; get_rx_data&amp;nbsp; &amp;nbsp;&amp;lt;= !hwrite &amp;amp;&amp;amp; addr == 0 ? hsize + 1 : 0;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; store_tx_data &amp;lt;= hwrite &amp;amp;&amp;amp; addr == 0 ? hsize + 1 : 0;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;always:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; d_mode&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; = tx_transfer_active;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; tx_data&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;= hwdata;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; clear_data_buffer = |mem['hd]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Courier New;labelBorderColor=default;" vertex="1" parent="1">
                    <mxGeometry x="400" y="1155" width="440" height="170" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="Overview:&lt;br&gt;&lt;br&gt;wait for enable (hsel)&lt;br&gt;&lt;br&gt;decode address:&lt;br&gt;&amp;nbsp; &amp;nbsp; drop lsb(s) based on hsize&lt;br&gt;&amp;nbsp; &amp;nbsp; set error if applicable&lt;br&gt;&lt;br&gt;if error:&lt;br&gt;&amp;nbsp; &amp;nbsp; hready low until bus idle&lt;br&gt;&amp;nbsp; &amp;nbsp; goto top&lt;br&gt;&lt;br&gt;if read:&lt;br&gt;&amp;nbsp; &amp;nbsp; pull value from memory into output register&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; if address is 0:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; request more data from buffer&lt;br&gt;&lt;br&gt;if write:&lt;br&gt;&amp;nbsp; &amp;nbsp; register address and size&lt;br&gt;&amp;nbsp; &amp;nbsp; next clock cyle:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; pull hwdata into specified address&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; unless address is 0, in which case:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; tell data buffer to grab size bytes" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Courier New;labelBorderColor=default;" vertex="1" parent="1">
                    <mxGeometry x="400" y="505" width="360" height="330" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>